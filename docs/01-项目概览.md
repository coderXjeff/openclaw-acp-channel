# ACP Channel 插件 - 项目概览

## 基本信息

| 项目 | 说明 |
|------|------|
| 名称 | `@openclaw/acp` |
| 版本 | 2.0.0 |
| 类型 | OpenClaw Channel 插件 |
| 语言 | TypeScript (ES2022) |
| 模块系统 | ESM (NodeNext) |
| 核心依赖 | `acp-ts` ^1.0.6 |

## 项目定位

本项目是一个 **OpenClaw Channel 插件**，用于将 OpenClaw Gateway 接入 ACP（Agent Communication Protocol）网络。它使 AI Agent 能够通过 ACP 协议与其他 Agent 进行点对点通信。

### 核心价值

- **无需 Python Bridge** — 直接使用 TypeScript/Node.js 连接 ACP 网络，无需额外的 Python 进程
- **简化部署** — 只需运行 OpenClaw Gateway，插件自动处理 ACP 连接
- **持久消息监听** — 支持多轮对话，自动管理会话生命周期
- **会话复用** — 自动复用已有会话，避免重复创建连接

## 目录结构

```
acp-channel/
├── index.ts                    # 主入口 - 插件注册与初始化
├── package.json                # 项目配置
├── tsconfig.json               # TypeScript 编译配置
├── openclaw.plugin.json        # OpenClaw 插件声明
│
├── src/                        # 核心源代码
│   ├── node-polyfill.ts        # Node.js 浏览器 API 兼容层
│   ├── acp-client.ts           # ACP 客户端封装
│   ├── channel.ts              # Channel 插件适配器定义
│   ├── monitor.ts              # 消息监听与会话管理
│   ├── actions.ts              # 消息操作处理
│   ├── outbound.ts             # 出站消息发送
│   ├── types.ts                # TypeScript 类型定义
│   ├── config-schema.ts        # 配置 Schema
│   ├── plugin-types.ts         # 插件类型定义
│   └── runtime.ts              # 运行时管理
│
├── skill/                      # OpenClaw Skill 定义
│   └── acp/
│       ├── SKILL.md
│       └── resources/
│           ├── install-full.md
│           ├── install-quick.md
│           └── usage-guide.md
│
├── prompts/                    # 提示词模板
│   └── install-acp.md
│
└── docs/                       # 文档目录
```

## 技术栈

| 技术 | 用途 |
|------|------|
| TypeScript 5.9+ | 主开发语言 |
| acp-ts | ACP 网络通信库 |
| OpenClaw SDK | 插件框架 |
| WebSocket | 实时消息传输 |
| Node.js 文件系统 | 本地存储 (localStorage 兼容) |

## 核心特性一览

| 特性 | 说明 |
|------|------|
| 直接 ACP 连接 | 无需 Python Bridge，纯 TypeScript 实现 |
| 会话管理 | 自动复用、LRU 淘汰、并发控制 |
| 权限控制 | Owner/External Agent 区分、allowFrom 白名单 |
| 4 层会话终止 | 软控制 → 协议层 → 硬限制 → 并发控制 |
| agent.md 管理 | 自动上传、MD5 缓存、作为系统提示词注入 |
| 防死循环 | 自动阻止自己给自己发消息 |
| AID 格式识别 | 自动识别 `agent-name.aid.pub` 格式 |
